import cv2
import numpy as np

# Load the image in grayscale
image = cv2.imread('your_image.jpg', cv2.IMREAD_GRAYSCALE)

# Apply Sobel operator to find gradients in the x direction (left to right)
sobelx = cv2.Sobel(image, cv2.CV_64F, 1, 0, ksize=3)  # Sobel X (horizontal gradient)

# Threshold to keep only positive gradients (dark to light from left to right)
sobelx_positive = np.maximum(sobelx, 0)  # Keep only positive gradients

# Normalize and convert to 8-bit format for visualization
sobelx_positive = cv2.normalize(sobelx_positive, None, 0, 255, cv2.NORM_MINMAX).astype(np.uint8)

# Create a mask to keep only the left edge of the rectangle
# Assuming the left edge is within the left half of the image
height, width = sobelx_positive.shape
mask = np.zeros_like(sobelx_positive)
mask[:, :width // 2] = 255  # Keep only the left half

# Apply the mask to get only the left edge
left_edge = cv2.bitwise_and(sobelx_positive, sobelx_positive, mask=mask)

# Optional: Find contours to refine the left edge detection
contours, _ = cv2.findContours(left_edge, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
left_edge_refined = np.zeros_like(left_edge)
if contours:
    # Find the leftmost contour point
    leftmost_contour = min(contours, key=lambda c: cv2.boundingRect(c)[0])
    cv2.drawContours(left_edge_refined, [leftmost_contour], -1, 255, 1)

# Display the result
cv2.imshow('Left Edge Only', left_edge_refined)
cv2.waitKey(0)
cv2.destroyAllWindows()
